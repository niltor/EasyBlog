# 服务注入

框架通过扩展方法，会为你添加Web开发中需要注入的服务和选项等。

## 框架依赖

框架依赖指的是按照约定，需要添加的服务和选项等。如:

- AddOptions：添加配置选项
- AddCache：缓存服务
- AddDbContext：数据库服务
- Manager的注入：源代码生成器？

它的扩展方法在`ShareModule`中的`SharedServiceExtensions`中定义。

## API服务

指运行接口服务，可能用到的内容，包括`Aspire`的`ServiceDefaults`中的内容。通常包括:

- 授权：
- 验证：
- 速率限制：
- CORS：优先配置文件，默认允许所有
- OpenAPI：
- 健康检查: ServiceDefaults中提供
- Contrller Endpoint:默认配置
- Json解析配置：默认配置

它的扩展方法在`Defintion`中的`ServiceExtensions`中定义。

部分服务可·通过配置文件中`Component`节点进行配置。

### OpenApi配置

使用微软官方的`Microsoft.AspNetCore.OpenApi`包，其默认路由略有不同，如:

```csharp
builder.Services.AddOpenApi("internal"); // Document name is internal
```

那么其访问url如：` http://localhost:5000/openapi/internal.json`。

> [!IMPORTANT]
> 在生成客户端请求时，将使用url中最后的`internal`作为目录区分。

