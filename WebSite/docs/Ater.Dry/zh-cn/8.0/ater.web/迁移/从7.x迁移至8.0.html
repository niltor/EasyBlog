<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ä»7.x è¿ç§»è‡³8.0</title>
    <meta name="description" content="@{Description}" />
    <base href="/" />
    <link rel="stylesheet" href="/css/app.css" />
    <link rel="stylesheet" href="/css/docs.css" />
    <link rel="stylesheet" href="/css/markdown.css" />
    <link rel="icon" type="image/png" href="/favicon.ico" />
    <script>const baseUrl = '/';</script>
    <script src="/js/docs.js"></script>
    <script src="/js/markdown.js"></script>
    
</head>

<body class="dark:bg-neutral-900">
  <div class="text-white py-2 bg-block">
    <div class="container mx-auto flex items-center space-x-4">
      <div class="flex-none">
        <a href="/" class="text-2xl font-semibold hidden sm:block">ç‹¬æ€</a>
      </div>
      <div class="flex-grow text-left flex space-x-4 items-center">
         <a href="/blogs.html" class="block py-2 text text-lg">Blogs</a>
<div class="relative dropdown">
  <div>
    <button type="button" class="flex items-center gap-x-1 text text-lg">
      Docs
      <svg class="-mr-1 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"
        data-slot="icon">
        <path fill-rule="evenodd"
          d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z"
          clip-rule="evenodd" />
      </svg>
    </button>
  </div>
  <div class="absolute z-10 mt-2 w-56 origin-top-right rounded-md bg-card dropdown-content hidden" tabindex="-1">
    <div class="py-1" role="none">
      <a href="/docs/Ater.Dry\zh-cn\9.0\å®‰è£….html" class="block px-4 py-2 text">Ater.Dry</a>

    </div>
  </div>
</div>
<a href="/about.html" target="_blank" class="block py-2 text text-lg ">About</a>

      </div>
      <div class="flex-none flex items-center">
        <div class="relative dropdown">
    <div class="relative inline-block cursor-pointer">
      <button type="button" class="flex items-center gap-x-1 text text-lg">
        ğŸŒ
      </button>
    </div>
    <div class="absolute right-0 mt-1 w-24 rounded-md bg-card dropdown-content hidden z-10 text-center">
        <div id="languageSelect" class="py-1" role="none">
        <a href="javascript:void(0);" onclick="doc.selectLanguage('zh-cn')" class="block px-3 py-1 text">zh-cn</a><a href="javascript:void(0);" onclick="doc.selectLanguage('en-us')" class="block px-3 py-1 text">en-us</a>
        </div>
    </div>
</div>
      </div>
    </div>
    </div>

    <div class="container mx-auto" style="margin-bottom: 48px;">
      <div id="docData" data-id="d6698d2ab0a0cd3a6e6f905c721b38a7" class="hidden" data-docName="Ater.Dry" data-language="zh-cn" data-version="8.0"></div>
      <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mt-2 pt-2">
        <div class="hidden md:block lg:col-span-1 sticky pe-4 top-0 h-fit">
        <div>
          <strong>Version</strong>
        </div>
        <select id="versionSelect" class="border border-gray-300 rounded-md p-1 my-2 bg-block w-full">

<option value='8.0'>8.0</option>
<option value='9.0'>9.0</option>
</select>
<div class="tree">
<ul class="root-list">
<li><span class="caret">ater.dry</span>
<ul class="nested">
<li id="88b84f4c72c822f7bbe7d7d8341df417" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\æ¦‚è¿°.html">æ¦‚è¿°</a>
</li>
<li id="ddc7db874edec392b7f897be611a5687" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å®‰è£….html">å®‰è£…</a>
</li>
<li id="5447e931e2a637c3716c7d42e5831170" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\åˆ›å»ºå¹¶è¿è¡Œé¡¹ç›®.html">åˆ›å»ºå¹¶è¿è¡Œé¡¹ç›®</a>
</li>
<li><span class="caret">Studio</span>
<ul class="nested">
<li id="2435df446daeeb11b66323bd7d93d02f" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\Studio\ä½¿ç”¨Dry Studio.html">ä½¿ç”¨Dry Studio</a>
</li>
<li id="9d2035706beb24b4c8d27b599cc1ecdf" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\Studio\é…ç½®è¯´æ˜.html">é…ç½®è¯´æ˜</a>
</li>
<li id="74c8d7a0a9427667aa6e375f6c5365fc" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\Studio\ç–‘éš¾é—®é¢˜.html">ç–‘éš¾é—®é¢˜</a>
</li>
<li id="3387804e7cb21791ed148c6cd496666a" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\Studio\é«˜çº§è‡ªå®šä¹‰åŠŸèƒ½.html">é«˜çº§è‡ªå®šä¹‰åŠŸèƒ½</a>
</li>
</ul>
<li><span class="caret">ä»£ç ç”Ÿæˆè¯´æ˜</span>
<ul class="nested">
<li id="17aa4b69e325cf265a5cb147484e528c" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\ä»£ç ç”Ÿæˆè¯´æ˜\DTOç”Ÿæˆ.html">DTOç”Ÿæˆ</a>
</li>
<li id="ac8684eeec6f4de991bc2440e1bd2687" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\ä»£ç ç”Ÿæˆè¯´æ˜\Managerç”Ÿæˆ.html">Managerç”Ÿæˆ</a>
</li>
</ul>
<li><span class="caret">å‘½ä»¤è¡Œ</span>
<ul class="nested">
<li id="a27a698b44892f1785a905a9da4babb9" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\Dtoç”Ÿæˆ.html">Dtoç”Ÿæˆ</a>
</li>
<li id="8761241a043518c33686b08c144a0796" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\Managerç”Ÿæˆ.html">Managerç”Ÿæˆ</a>
</li>
<li id="28f4e723fafde6ab01e7423f6e14007a" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\æ§åˆ¶å™¨æ¥å£ç”Ÿæˆ.html">æ§åˆ¶å™¨æ¥å£ç”Ÿæˆ</a>
</li>
<li id="ae0d05dd8d8de298adcb3040038a60c2" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\å‰ç«¯è¯·æ±‚æœåŠ¡ç”Ÿæˆ.html">å‰ç«¯è¯·æ±‚æœåŠ¡ç”Ÿæˆ</a>
</li>
<li id="2584901811ed0290b9f82b2a83e4cbbb" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\Studio.html">Studio</a>
</li>
<li id="4dbfea513e14d8ee06bed08c3357c852" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.dry\å‘½ä»¤è¡Œ\é…ç½®.html">é…ç½®</a>
</li>
</ul>
</ul>
<li><span class="caret">ater.web</span>
<ul class="nested">
<li id="78e00999d031a9578f8d1aec3bcfe740" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ¦‚è¿°.html">æ¦‚è¿°</a>
</li>
<li><span class="caret">æ•™ç¨‹</span>
<ul class="nested">
<li id="c98432e86fd50ca98cf824ee7f65a3c7" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ•™ç¨‹\é¡¹ç›®ç»“æ„è¯´æ˜.html">é¡¹ç›®ç»“æ„è¯´æ˜</a>
</li>
<li><span class="caret">åˆ†å±‚é¡¹ç›®è¯´æ˜</span>
<ul class="nested">
<li id="bdc01c94283767f904e72218eb04c3d3" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ•™ç¨‹\åˆ†å±‚é¡¹ç›®è¯´æ˜\Infrastructure.html">Infrastructure</a>
</li>
<li id="88ecd9c66db6bb2ffecae5908bbecb5f" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ•™ç¨‹\åˆ†å±‚é¡¹ç›®è¯´æ˜\Definition.html">Definition</a>
</li>
<li id="7c3554d8b99a341e6621c7a1682aec5e" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ•™ç¨‹\åˆ†å±‚é¡¹ç›®è¯´æ˜\Application.html">Application</a>
</li>
</ul>
<li id="d4fe3e2ce41b93d818835e97cdf5a97c" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\æ•™ç¨‹\ç»„ç»‡ä»£ç .html">ç»„ç»‡ä»£ç </a>
</li>
</ul>
<li id="c9b4f7db5ee0b547a237e5c2e36e7259" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\å¿«é€Ÿå…¥é—¨.html">å¿«é€Ÿå…¥é—¨</a>
</li>
<li><span class="caret">çº¦å®šå’Œè§„èŒƒ</span>
<ul class="nested">
<li id="f1a5b050ff337e605d02a7bb2e7649c3" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\çº¦å®šå’Œè§„èŒƒ\RESTful API.html">RESTful API</a>
</li>
<li id="eca831e760c17288b3d326c2dccf8354" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\çº¦å®šå’Œè§„èŒƒ\å®ä½“å®šä¹‰.html">å®ä½“å®šä¹‰</a>
</li>
<li id="338f4b45ed70bbfa9f5a7d8a898774f6" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\çº¦å®šå’Œè§„èŒƒ\ç¬¬ä¸‰æ–¹ä¾èµ–.html">ç¬¬ä¸‰æ–¹ä¾èµ–</a>
</li>
<li id="abec1ab893db8e917aaa2a61cdf783c3" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\çº¦å®šå’Œè§„èŒƒ\çº¦å®š.html">çº¦å®š</a>
</li>
</ul>
<li><span class="caret">åŠŸèƒ½æ¨¡å—</span>
<ul class="nested">
<li id="774b9ca01fb71dde93fefa33f0d3575e" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\åŠŸèƒ½æ¨¡å—\Systemæ¨¡å—.html">Systemæ¨¡å—</a>
</li>
</ul>
<li><span class="caret">é«˜çº§</span>
<ul class="nested">
<li id="39b71a3228fdab30d42a1611c0770458" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\é«˜çº§\ä¸šåŠ¡æ—¥å¿—è®°å½•.html">ä¸šåŠ¡æ—¥å¿—è®°å½•</a>
</li>
</ul>
<li id="f7b151e5ea61c8743a48f5f87ca13ffd" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\ç¤ºä¾‹.html">ç¤ºä¾‹</a>
</li>
<li id="8e339a072a6caa395c9752ed6206f09d" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\å¸¸è§é—®é¢˜.html">å¸¸è§é—®é¢˜</a>
</li>
<li><span class="caret">è¿ç§»</span>
<ul class="nested">
<li id="d6698d2ab0a0cd3a6e6f905c721b38a7" class="space">
    <a class="text" href="/docs/Ater.Dry\zh-cn\8.0\ater.web\è¿ç§»\ä»7.xè¿ç§»è‡³8.0.html">ä»7.xè¿ç§»è‡³8.0</a>
</li>
</ul>
</ul>
<li><span class="caret">images</span>
<ul class="nested">
</ul>
</ul>
</div>

        </div>
        <div class="col-span-1 md:col-span-2 lg:col-span-2 markdown-content">
        <h1 id="ä»7x-è¿ç§»è‡³80">ä»7.x è¿ç§»è‡³8.0</h1>
<p>ä»7.xç‰ˆæœ¬è¿ç§»è‡³8.0ï¼Œç›®å½•ç»“æ„å‘ç”Ÿäº†é‡å¤§çš„å˜åŒ–ï¼Œéœ€è¦æ‰‹åŠ¨é‡æ„é¡¹ç›®ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« ç»™å‡ºä¸€ä¸ªè¿ç§»è¯´æ˜ï¼Œå¸®åŠ©å¤§å®¶è¿ç§»åˆ°8.0</p>
<h2 id="å‡†å¤‡">å‡†å¤‡</h2>
<p>æ‹‰å–æœ€æ–°<code>ater.web</code>æ¨¡æ¿å†…å®¹ï¼Œ<a href="https://github.com/AterDev/ater.web">GitHubåœ°å€</a>.</p>
<p>å…¶æ¨¡æ¿è§£å†³æ–¹æ¡ˆè§£å†³æ–¹æ¡ˆåœ¨<code>templates/apistd</code>ç›®å½•ä¸­ã€‚</p>
<p>æˆ‘ä»¬å°†å‚ç…§è¯¥æœ€æ–°çš„æ¨¡æ¿æ¥å°†æ—§é¡¹ç›®è¿ç§»åˆ°æ–°é¡¹ç›®ã€‚</p>
<div class="markdown-alert markdown-alert-important">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p>
<p>è¯·åŠ¡å¿…åœ¨æ–°çš„åˆ†æ”¯ä¸Šæ‰§è¡Œå‡çº§æ“ä½œï¼Œå¹¶ä¿æŒè¶³å¤Ÿçš„è€å¿ƒï¼Œé‡æ„å¯èƒ½éœ€è¦æ•°ä¸ªå°æ—¶ã€‚</p>
<p>è¯·ä½¿ç”¨VSæˆ–Riderç­‰IDEæ¥å®Œæˆç›¸å…³çš„é‡æ„ç›¸å…³çš„å·¥ä½œï¼Œä»¥èŠ‚çœæ—¶é—´ã€‚</p>
</div>
<h2 id="å‡çº§åˆ°net80">å‡çº§åˆ°.NET8.0</h2>
<p>å°†æ—§é¡¹ç›®çš„.NETç‰ˆæœ¬åŠç›¸å…³ä¾èµ–å‡çº§åˆ°8.0ã€‚</p>
<h2 id="ç§»é™¤imanageræ¥å£å±‚">ç§»é™¤IManageræ¥å£å±‚</h2>
<p>åœ¨7.2ç‰ˆæœ¬åï¼Œç§»é™¤äº†IManageræ¥å£å±‚ï¼Œå¦‚æœä½ ä½¿ç”¨ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œéœ€è¦å…ˆç§»é™¤æ‰€æœ‰IxxxManageræ–‡ä»¶ï¼Œå¹¶ä¿®å¤ç›¸å…³å¼•ç”¨å’Œå‘½åç©ºé—´ã€‚</p>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</p>
<p>å¯ä»¥ä½¿ç”¨VSä¸­çš„æŸ¥æ‰¾å’Œæ›¿æ¢(æ­£åˆ™æ›¿æ¢)æ‰¹é‡ä¿®æ”¹ç›¸å…³å†…å®¹ã€‚</p>
</div>
<h2 id="é‡æ„åˆ°8x">é‡æ„åˆ°8.x</h2>
<h3 id="1-å¤åˆ¶-infrastructure">1 å¤åˆ¶ Infrastructure</h3>
<p>8.0ç‰ˆæœ¬å°†ç›¸å…³åŸºç¡€ä¾èµ–å°è£…åˆ°äº†<code>src/Infrastructure</code>ç›®å½•ï¼Œåœ¨æ–°æ¨¡æ¿ä¸­ï¼Œæ‰¾åˆ°è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶å¤åˆ¶åˆ°æ—§ç‰ˆæœ¬çš„<code>src</code>ç›®å½•ä¸­ã€‚</p>
<p>åœ¨è§£å†³æ–¹æ¡ˆä¸­åˆ›å»ºInfrastructureæ–‡ä»¶å¤¹ï¼Œå¹¶å°†å…¶ä¸­çš„ä¸‰ä¸ªç°æœ‰é¡¹ç›®æ·»åŠ åˆ°è§£å†³æ–¹æ¡ˆä¸­ã€‚</p>
<h3 id="2-è°ƒæ•´é¡¹ç›®ç»“æ„">2 è°ƒæ•´é¡¹ç›®ç»“æ„</h3>
<ol>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹åˆ›å»ºç›®å½•<code>Definition</code>ï¼ŒåŒæ—¶åˆ›å»ºè§£å†³æ–¹æ¡ˆç›®å½•ã€‚</li>
<li>å°†åŸ<code>Core</code>é¡¹ç›®é‡å‘½åä¸º<code>Entity</code>ï¼Œå¹¶ç§»åŠ¨åˆ°<code>Definition</code>ç›®å½•ä¸­ã€‚</li>
<li>å°†<code>Share</code>ä»¥åŠ<code>Database</code>ä¸‹çš„<code>EntityFramework</code>é¡¹ç›®ç§»åŠ¨åˆ°<code>Definition</code>ç›®å½•ä¸­ã€‚</li>
<li>è°ƒæ•´.slnæ–‡ä»¶ä¸­çš„ç›®å½•çš„ç›®å½•è·¯å¾„ï¼Œå¦‚:</li>
</ol>
<div class="markdown-alert markdown-alert-important">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p>
<p>ä»¥ä¸Šç§»åŠ¨åŒ…æ‹¬æœ¬åœ°æ–‡ä»¶ç›®å½•çš„ç§»åŠ¨ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆçš„ç§»åŠ¨ï¼Œä»¥ä¿æŒè§£å†³æ–¹æ¡ˆç»“æ„è·Ÿæ–‡ä»¶ç»“æ„ä¸€è‡´ã€‚</p>
</div>
<div class="language-ini"><pre>
Project(&quot;{9A19103F-16F7-4668-BE54-9A1E7A4F7556}&quot;) = &quot;Entity&quot;, &quot;src\Definition\Entity\Entity.csproj&quot;, &quot;{98B3C835-3D2B-4BA8-A197-6EA842A75C31}&quot;
EndProject
Project(&quot;{9A19103F-16F7-4668-BE54-9A1E7A4F7556}&quot;) = &quot;EntityFramework&quot;, &quot;src\Definition\EntityFramework\EntityFramework.csproj&quot;, &quot;{9BDFBC64-469E-4CE6-B1AB-36C8E5E2E4E4}&quot;
EndProject
Project(&quot;{9A19103F-16F7-4668-BE54-9A1E7A4F7556}&quot;) = &quot;Share&quot;, &quot;src\Definition\Share\Share.csproj&quot;, &quot;{5D8DD758-141F-452D-A69C-B2652C1ABF91}&quot;
EndProject
</pre></div>
<div class="markdown-alert markdown-alert-important">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p>
<p>é¡¹ç›®é‡å‘½åæ—¶ï¼ŒåŒæ—¶è¦å°†ç³»ç»Ÿæ–‡ä»¶ç›®å½•ä¸‹çš„åç§°ä¹Ÿä¿®æ”¹ã€‚</p>
</div>
<h3 id="3-ä¿®å¤é¡¹ç›®å¼•ç”¨">3 ä¿®å¤é¡¹ç›®å¼•ç”¨</h3>
<p>æ–‡ä»¶ç›®å½•ä¿®æ”¹åï¼Œé‡æ–°æ‰“å¼€è§£å†³æ–¹æ¡ˆé¡¹ç›®ï¼Œç„¶åä¿®å¤é¡¹ç›®å¼•ç”¨çš„è·¯å¾„ã€‚å¯ä»¥å…ˆåˆ é™¤åŸé¡¹ç›®å¼•ç”¨ ï¼Œç„¶åå†æ‰‹åŠ¨æ·»åŠ æ–°é¡¹ç›®å¼•ç”¨ã€‚ä¸»è¦åŒ…æ‹¬ï¼š</p>
<p>å¯¹äº<code>Http.API</code>é¡¹ç›®:</p>
<div class="language-xml"><pre>
<span class="xmlDelimiter">&lt;</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Application\Application.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Infrastructure\Ater.Web.Extension\Ater.Web.Extension.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
<span class="xmlDelimiter">&lt;/</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
</pre></div>
<p>å¯¹äº<code>Application</code>é¡¹ç›®:</p>
<div class="language-xml"><pre>
<span class="xmlDelimiter">&lt;</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Definition\EntityFramework\EntityFramework.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Definition\Share\Share.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
<span class="xmlDelimiter">&lt;/</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
</pre></div>
<p>å¯¹äº<code>Share</code>é¡¹ç›®:</p>
<div class="language-xml"><pre>
<span class="xmlDelimiter">&lt;</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Entity\Entity.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
<span class="xmlDelimiter">&lt;/</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
</pre></div>
<p>å¯¹äº<code>Entityframework</code>é¡¹ç›®:</p>
<div class="language-xml"><pre>
<span class="xmlDelimiter">&lt;</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\Entity\Entity.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\..\Infrastructure\Ater.Web.Abstraction\Ater.Web.Abstraction.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
<span class="xmlDelimiter">&lt;/</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
</pre></div>
<p>å¯¹äº<code>Entity</code>é¡¹ç›®:</p>
<div class="language-xml"><pre>
<span class="xmlDelimiter">&lt;</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
    <span class="xmlDelimiter">&lt;</span><span class="xmlName">ProjectReference</span> <span class="xmlAttribute">Include</span><span class="xmlDelimiter">=</span><span class="xmlAttributeQuotes">&quot;</span><span class="xmlAttributeValue">..\..\Infrastructure\Ater.Web.Core\Ater.Web.Core.csproj</span><span class="xmlAttributeQuotes">&quot;</span> <span class="xmlDelimiter">/&gt;</span>
<span class="xmlDelimiter">&lt;/</span><span class="xmlName">ItemGroup</span><span class="xmlDelimiter">&gt;</span>
</pre></div>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</p>
<p>å¯ä»¥å‚ç…§æ–°æ¨¡æ¿ä¸­çš„å¼•ç”¨å…³ç³»ã€‚</p>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šå¯¹æ¯ä¸ªé¡¹ç›®è¿›è¡Œè¿ç§»å’Œé”™è¯¯ä¿®å¤ã€‚</p>
<h3 id="ä¿®å¤entityé¡¹ç›®">ä¿®å¤Entityé¡¹ç›®</h3>
<p>è¯¥é¡¹ç›®å¯¹åº”åŸæ¥çš„<code>Core</code>é¡¹ç›®ã€‚è¯¥é¡¹ç›®åº”è¯¥åªä¿ç•™ä¸å®ä½“ç›¸å…³çš„å†…å®¹ã€‚</p>
<ol>
<li><p>åˆ é™¤<code>Const</code>,<code>Models</code>,<code>Utils</code>ç›®å½•(å¦‚æœæœ‰)ï¼Œ<strong>å¦‚æœæœ‰ä½ è‡ªå®šä¹‰çš„ä»£ç ï¼Œéœ€è¦ä¿ç•™</strong>ã€‚</p>
</li>
<li><p>å°†æ‰€æœ‰å®ä½“ä»<code>Entities</code>ç›®å½•ç§»åŠ¨åˆ°æ ¹ç›®å½•(å­ç›®å½•ä»ç„¶ä¿ç•™)ï¼Œåªæ˜¯å»é™¤äº†è¯¥å±‚ç›®å½•ã€‚</p>
</li>
<li><p>ä¿®æ”¹å®ä½“ç»§æ‰¿</p>
<p>8.xç‰ˆæœ¬ä¸­çš„æ‰€æœ‰å®ä½“ä¸å†ç»§æ‰¿<code>EntityBase</code>ï¼Œè€Œä¿®æ”¹æˆ<code>IEntityBase</code>ã€‚
åšå‡ºè¯¥é¡¹ä¿®æ”¹æ˜¯å› ä¸º<code>EF Core 8.0</code>å¯¹ <strong><code>Jsonåˆ—</code></strong> çš„æ”¯æŒå¹¶ä¸æ”¯æŒ<code>TPC</code>ç»§æ‰¿å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å†ä½¿ç”¨ç»§æ‰¿ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨VSä¸­çš„æŸ¥çœ‹å’Œæ›¿æ¢åŠŸèƒ½ï¼ŒæŸ¥æ‰¾èŒƒå›´è®¾å®šä¸ºè¯¥é¡¹ç›®ï¼Œå°†æ‰€æœ‰<code>: EntityBase</code>æ›¿æ¢æˆ<code>: IEntityBase</code>ã€‚</p>
</li>
<li><p>ä¿®æ”¹<code>GlobalUsings.cs</code>ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p>
<div class="language-csharp"><pre>
global <span class="keyword">using</span> System.<span class="className">ComponentModel</span>.<span class="variable">DataAnnotations</span>;
global <span class="keyword">using</span> System.ComponentModel.<span class="className">DataAnnotations</span>.<span class="variable">Schema</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Models</span>;
global <span class="keyword">using</span> <span class="className">Microsoft</span>.<span class="variable">EntityFrameworkCore</span>;
</pre></div>
<p>ä»¥åŠæ·»åŠ ä½ éœ€è¦çš„å‘½åç©ºé—´ã€‚</p>
</li>
<li><p>ç°åœ¨å·²ç»ç»§æ‰¿äº†<code>IEntityBase</code>ï¼Œé‚£ä¹ˆéœ€è¦å®ç°å…¶ä¸­çš„å±æ€§ï¼Œåœ¨VSä¸­æ‰“å¼€ä¸€ä¸ªå®ä½“æ–‡ä»¶ï¼Œå³é”®æ¥å£åç§°ï¼Œé€‰æ‹©å¿«é€Ÿé‡æ„ï¼Œå®ç°æ¥å£å†…å®¹å¹¶åº”ç”¨åˆ°æ•´ä¸ªé¡¹ç›®ï¼Œè¿™æ ·ä½ ä¸éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ¯ä¸ªå®ä½“æ–‡ä»¶ã€‚</p>
</li>
<li><p>ä¿®å¤å‘½åç©ºé—´å¼•ç”¨é”™è¯¯ï¼Œå»ºè®®ä½¿ç”¨VSä¸­çš„ä»£ç æ¸…ç†åŠŸèƒ½ã€‚</p>
<p>å³é”®é¡¹ç›®ï¼Œé€‰æ‹©ä»£ç åˆ†æå’Œæ¸…ç†ï¼Œå¦‚æœä½ æ²¡é…ç½®è¿‡ï¼Œè¯·å…ˆé…ç½®ä»£ç æ¸…ç†ã€‚é…ç½®å®Œæˆåé€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªé…ç½®ç”¨äºä»£ç æ¸…ç†ã€‚</p>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</p>
<p>é…ç½®å¹¶ä½¿ç”¨ä»£ç æ¸…ç†åŠŸèƒ½ï¼Œå¯ä»¥é¿å…æ‰‹åŠ¨å¯¹æ¯ä¸ªæ–‡ä»¶ä¸­çš„é”™è¯¯è¿›è¡Œä¿®å¤ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ ç§»é™¤é”™è¯¯çš„å‘½åç©ºé—´å¼•ç”¨ï¼Œè¯·ä½¿ç”¨å·¥å…·ã€‚</p>
</div>
</li>
<li><p>é‡æ–°Build<code>Entity</code>é¡¹ç›®ï¼Œç»§ç»­ä¿®å¤å…¶ä»–é—®é¢˜ï¼Œç›´åˆ°æ„å»ºæˆåŠŸã€‚</p>
</li>
</ol>
<h3 id="ä¿®å¤shareé¡¹ç›®">ä¿®å¤Shareé¡¹ç›®</h3>
<ol>
<li><p>åˆ é™¤<code>Models</code>ä¸­çš„</p>
<ul>
<li>PageList.cs</li>
<li>FilterBase.cs</li>
</ul>
<p>è¯¥ç±»å·²ç»åœ¨<code>Ater.Web.Core</code>ä¸­å®šä¹‰ã€‚</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>Options</code>ç›®å½•å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ä¸­ã€‚</p>
</li>
<li><p>ä½¿ç”¨ä»£ç æ¸…ç†åŠŸèƒ½ï¼Œå¹¶å¤„ç†å‘½åç©ºé—´å¼•ç”¨ç›¸å…³é”™è¯¯ã€‚</p>
</li>
<li><p>ç„¶åBuildé¡¹ç›®ï¼Œå¤„ç†å…¶ä»–ä¸šåŠ¡ä¾èµ–é—®é¢˜ï¼Œç›´åˆ°buildæˆåŠŸã€‚</p>
</li>
</ol>
<h3 id="ä¿®å¤entityframework">ä¿®å¤EntityFramework</h3>
<ol>
<li><p>åœ¨VSä¸­åˆ›å»ºæ–°è§£å†³æ–¹æ¡ˆç›®å½•<code>DBProvider</code>ï¼Œå°†<code>CommandDbContext.cs</code>,<code>QueryDbContext.cs</code>å’Œ<code>ContextBase.cs</code>ç§»åŠ¨åˆ°è¯¥ç›®å½•ä¸‹ã€‚</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>CommandDbContextFactory.cs</code>å’Œ<code>QueryDbContextFactory.cs</code>æ–‡ä»¶ä¹Ÿå¤åˆ¶åˆ°å½“å‰é¡¹ç›®ã€‚</p>
</li>
<li><p>ç„¶åä¿®æ”¹<code>ContextBase.cs</code>ä¸­çš„ä»£ç ã€‚</p>
<p>åˆ é™¤<code>OnModelCreating</code>æ–¹æ³•ä¸­çš„</p>
<div class="language-csharp"><pre>
<span class="variable">builder</span>.<span class="className">Entity</span>&lt;<span class="symbol">EntityBase</span>&gt;<span class="controlKeyword">(</span><span class="controlKeyword">)</span>.<span class="function">UseTpcMappingStrategy</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
</pre></div>
<p>ç„¶åå°†æ–°æ¨¡æ¿ä¸­<code>ContextBase.cs</code>çš„ <code>SaveChangesAsync</code>,<code>OnModelExtendCreating</code>,<code>OnSqliteModelCreating</code>å’Œ<code>ConvertFilterExpression</code>æ–¹æ³•å¤åˆ¶è¿‡æ¥ã€‚</p>
<p>å¹¶åœ¨<code>OnModelCreating</code>æ–¹æ³•ä¸­è°ƒç”¨<code>OnModelExtendCreating</code>æ–¹æ³•ï¼Œå¦‚:</p>
<div class="language-csharp"><pre>
<span class="variable">base</span>.<span class="function">OnModelCreating</span><span class="controlKeyword">(</span>builder<span class="controlKeyword">)</span>;
 <span class="function">OnModelExtendCreating</span><span class="controlKeyword">(</span>builder<span class="controlKeyword">)</span>;
</pre></div>
</li>
<li><p>ç§»é™¤<code>QueryDbContext.cs</code>ä¸­çš„å…¨å±€ç­›é€‰<code>builder.Entity&lt;EntityBase&gt;().HasQueryFilter(e =&gt; !e.IsDeleted);</code></p>
</li>
<li><p>å°†æ¨¡æ¿ä¸­çš„<code>DataAccessContext.cs</code>å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ã€‚</p>
</li>
<li><p>ä¿®æ”¹<code>GlobalUsings.cs</code>å†…å®¹ï¼Œå¦‚ä¸‹:</p>
<div class="language-csharp"><pre>
global <span class="keyword">using</span> System.<span class="className">Linq</span>.<span class="variable">Expressions</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Abstraction</span>.<span class="variable">Interface</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Models</span>;
global <span class="keyword">using</span> Entity;
global <span class="keyword">using</span> <span class="className">Microsoft</span>.<span class="variable">EntityFrameworkCore</span>;
</pre></div>
</li>
<li><p>ä½¿ç”¨ä»£ç æ¸…ç†åŠŸèƒ½ï¼Œå¹¶å¤„ç†å‘½åç©ºé—´å¼•ç”¨ç›¸å…³é”™è¯¯ã€‚</p>
</li>
<li><p>ç„¶åBuildé¡¹ç›®ï¼Œå¤„ç†å…¶ä»–ä¸šåŠ¡ä¾èµ–é—®é¢˜ï¼Œç›´åˆ°buildæˆåŠŸã€‚</p>
</li>
</ol>
<h3 id="ä¿®å¤application">ä¿®å¤Application</h3>
<h4 id="ç§»é™¤æ— ç”¨ä»£ç ">ç§»é™¤æ— ç”¨ä»£ç </h4>
<p>8.xç§»é™¤äº†DataStoreå±‚ï¼Œå¤§å¤§å‡å°‘äº†ç”Ÿæˆçš„ä»£ç ã€‚</p>
<ol>
<li><p>åˆ é™¤<code>CommandStore</code>å’Œ<code>QueryStore</code>ç›®å½•ã€‚</p>
</li>
<li><p>åˆ é™¤<code>Interface</code>ä¸­æ–‡ä»¶ï¼ŒåŒ…æ‹¬:</p>
<ul>
<li>ICommandStore.cs</li>
<li>ICommandStoreExt.cs</li>
<li>IDataStore.cs</li>
<li>IDomainManager.cs</li>
<li>IQueryStore.cs</li>
<li>IQueryStoreExt.cs`ã€‚</li>
</ul>
</li>
<li><p>åˆ é™¤<code>Implement</code>ä¸­æ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>CommandStoreBase.cs</li>
<li>DataStoreContext.cs</li>
<li>DataStoreBase.cs</li>
<li>DomainManagerBase.cs</li>
<li>QueryStoreBase.cs</li>
<li>StoreServicesExtensions.csï¼Œåœ¨åˆ é™¤ä¹‹å‰ï¼Œå¤åˆ¶<code>AddManager</code>ä¸­çš„Manageræ³¨å…¥çš„ä»£ç ã€‚</li>
</ul>
</li>
<li><p>ç§»é™¤<code>JwtService.cs</code>ã€‚è¯¥ç±»å·²åœ¨åŸºç¡€è®¾è®¡ä¸­å®ç°ï¼Œä¿®æ”¹äº†<code>GetToken</code>æ–¹æ³•çš„å‚æ•°ã€‚</p>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</p>
<p>ä¿®æ”¹æ—¶å¯å‚ç…§æ–°æ¨¡æ¿ä¸­çš„ç›®å½•ç»“æ„è¿›è¡Œè°ƒæ•´ã€‚</p>
</div>
</li>
</ol>
<h4 id="ä¿®æ”¹ä»£ç ">ä¿®æ”¹ä»£ç </h4>
<ol>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>AppServiceCollectionExtensions.cs</code>å’Œ<code>ManagerServiceCollectionExtensions.cs</code>å¤åˆ¶åˆ°å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œå¹¶å°†ä¹‹å‰ä»<code>StoreServicesExtensions.cs</code>å¤åˆ¶çš„Manageræ³¨å…¥ä»£ç ï¼Œå¤åˆ¶åˆ°è¯¥ç±»ä¸­çš„<code>AddManager</code>æ–¹æ³•ã€‚</p>
</li>
<li><p>å°†<code>IUserContext</code>æ¥å£ç»§æ‰¿<code>IUserContextBase</code>ï¼Œç„¶ååˆ é™¤å·²å­˜åœ¨çš„å±æ€§ï¼Œå¹¶å°†è¯¥æ–‡ä»¶ç§»åŠ¨åˆ°æ ¹ç›®å½•ä¸­ï¼Œå¹¶å‚ç…§æ–°æ¨¡æ¿è¡¥å……è¯¥æ¥å£æ–¹æ³•ï¼›</p>
</li>
<li><p>å¤åˆ¶æ–°æ¨¡æ¿ä¸­çš„<code>Implement\ManagerBase.cs</code>æ–‡ä»¶åˆ°å½“å‰é¡¹ç›®ä¸­çš„<code>Implement</code>ç›®å½•ä¸­ï¼›</p>
</li>
<li><p>å‚è€ƒæ–°æ¨¡æ¿ä¸­çš„<code>UserContext.cs</code>æ¥å®Œå–„å½“å‰çš„<code>UserContext.cs</code>ï¼Œæ¯”å¦‚å¯¹IsAdminçš„åˆ¤æ–­ã€‚</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>Const</code>ç›®å½•å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ï¼›</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>Service</code>ç›®å½•å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ï¼›</p>
</li>
<li><p>ä¿®æ”¹<code>GlobalUsings.cs</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹:</p>
<div class="language-csharp"><pre>
global <span class="keyword">using</span> System.<span class="className">Linq</span>.<span class="variable">Expressions</span>;
global <span class="keyword">using</span> System.<span class="className">Security</span>.<span class="variable">Claims</span>;
global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Implement</span>;
global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Manager</span>;
global <span class="keyword">using</span> Ater.<span class="className">Web</span>.<span class="variable">Abstraction</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Abstraction</span>.<span class="variable">Interface</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Models</span>;
global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Utils</span>;
global <span class="keyword">using</span> Entity;
global <span class="keyword">using</span> EntityFramework;
global <span class="keyword">using</span> <span class="className">Microsoft</span>.<span class="variable">EntityFrameworkCore</span>;
global <span class="keyword">using</span> Microsoft.<span class="className">Extensions</span>.<span class="variable">DependencyInjection</span>;
global <span class="keyword">using</span> Microsoft.<span class="className">Extensions</span>.<span class="variable">Logging</span>;
</pre></div>
</li>
<li><p>å¤„ç†Managerç»§æ‰¿ã€‚
Manageræ˜¯ç¼–å†™ä¸šåŠ¡é€»è¾‘çš„é‡è¦è½½ä½“ï¼Œ8.xå»é™¤äº†DataStoreç›¸å…³æ¦‚å¿µå’Œä»£ç ï¼Œéœ€è¦å¯¹æ‰€æœ‰çš„Managerè¿›è¡Œé‡æ„ï¼Œå³æˆ‘ä»¬éœ€è¦å°†</p>
<div class="language-csharp"><pre>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="className">ResourceManager</span> : DomainManagerBase&lt;Resource, ResourceUpdateDto, ResourceFilterDto, ResourceItemDto&gt;
<span class="controlKeyword">{</span>
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceTypeDefinitionManager typeDefinitionManager;
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceTagsManager tagsManager;
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceGroupManager resourceGroupManager;
    <span class="keyword">public</span> <span class="function">ResourceManager</span><span class="controlKeyword">(</span>DataStoreContext storeContext,
                           ResourceTypeDefinitionManager typeDefinitionManager,
                           ResourceTagsManager tagsManager,
                           ResourceGroupManager resourceGroupManager<span class="controlKeyword">)</span> : <span class="keyword">base</span><span class="controlKeyword">(</span>storeContext<span class="controlKeyword">)</span>
    <span class="controlKeyword">{</span>
        <span class="variable">this</span>.typeDefinitionManager = typeDefinitionManager;
        <span class="variable">this</span>.tagsManager = tagsManager;
        <span class="variable">this</span>.resourceGroupManager = resourceGroupManager;
    <span class="controlKeyword">}</span>
    <span class="comment">// ...</span>
<span class="controlKeyword">}</span>
</pre></div>
<p>ä¿®æ”¹æˆä»¥ä¸‹å½¢å¼:</p>
<div class="language-csharp"><pre>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="className">ResourceManager</span> : ManagerBase&lt;Resource, ResourceUpdateDto, ResourceFilterDto, ResourceItemDto&gt;
<span class="controlKeyword">{</span>
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceTypeDefinitionManager typeDefinitionManager;
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceTagsManager tagsManager;
    <span class="keyword">private</span> <span class="keyword">readonly</span> ResourceGroupManager resourceGroupManager;
    <span class="keyword">public</span> <span class="function">ResourceManager</span><span class="controlKeyword">(</span><span class="className">DataAccessContext</span>&lt;<span class="symbol">Resource</span>&gt; storeContext,
                           ILogger &lt;ResourceManager&gt; logger,
                           ResourceTypeDefinitionManager typeDefinitionManager,
                           ResourceTagsManager tagsManager,
                           ResourceGroupManager resourceGroupManager<span class="controlKeyword">)</span> : <span class="keyword">base</span><span class="controlKeyword">(</span>storeContext,logger<span class="controlKeyword">)</span>
    <span class="controlKeyword">{</span>
        <span class="variable">this</span>.typeDefinitionManager = typeDefinitionManager;
        <span class="variable">this</span>.tagsManager = tagsManager;
        <span class="variable">this</span>.resourceGroupManager = resourceGroupManager;
    <span class="controlKeyword">}</span>
    <span class="comment">// ....</span>
<span class="controlKeyword">}</span>
</pre></div>
<p>å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¿®æ”¹ï¼š</p>
<ol>
<li>ç»§æ‰¿çš„åŸºç±»ï¼Œå°†<code>DomainManagerBase</code>ä¿®æ”¹æˆ<code>ManagerBase</code>. å¯ä½¿ç”¨æœç´¢æ‰¹é‡æ›¿æ¢è¯¥é¡¹ç›®ä¸‹çš„å†…å®¹ï¼Œå¦‚æœç´¢<code>: DomainManagerBase&lt;</code>ï¼Œæ›¿æ¢æˆ<code>: ManagerBase&lt;</code></li>
<li>æ„é€ æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¦å°†å‚æ•°<code>DataStoreContext</code>ä¿®æ”¹æˆå¸¦æ³›å‹çš„<code>DataAccessContext&lt;xxx&gt;</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ­£åˆ™åŒ¹é…æ¥æ›¿æ¢ç›¸å…³çš„å†…å®¹ã€‚æˆ‘ä»¬å°†æœç´¢æ­£åˆ™è¡¨è¾¾å¼<code>\b(\w+)Manager\(DataStoreContext storeContext</code>ï¼Œæ›¿æ¢æˆ<code>$1Manager(DataAccessContext&lt;$1&gt; storeContext, ILogger&lt;$1Manager&gt; logger</code>ï¼›ç„¶åæœç´¢<code>: base(storeContext)</code>æ›¿æ¢æˆ<code>: base(storeContext, logger)</code></li>
</ol>
<div class="markdown-alert markdown-alert-warning">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Warning</p>
<p>è¯·å°½å¯èƒ½ä½¿ç”¨é€ä¸ªæ›¿æ¢ï¼Œä»¥é¿å…æ›¿æ¢é”™è¯¯çš„åŒ¹é…å†…å®¹ã€‚</p>
</div>
</li>
<li><p>å¦‚æœä½ ä½ åœ¨Managerä½¿ç”¨äº†ä¹‹å‰åŸºç±»ä¸­çš„å˜é‡æ¥è®¿é—®æ•°æ®åº“ï¼Œä½ å¯èƒ½éœ€è¦è¿›è¡Œæ›¿æ¢ï¼Œå¦‚ï¼š</p>
<ol>
<li><code>Stores.QueryContext.</code>=&gt;<code>QueryContext.</code></li>
<li><code>Stores.CommandContext.</code>=&gt;<code>CommandContext.</code></li>
<li><code>Query.Context.</code>=&gt;<code>QueryContext.</code></li>
<li><code>Command.Context.</code>=&gt;<code>CommandContext.</code></li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´è¦è®¿é—®DbContextï¼Œä¸å†éœ€è¦Stores,å¯ä»¥ç›´æ¥åœ¨Managerè®¿é—®ã€‚è¯·æŒ‰ç…§è¯¥æ–¹å¼ä¿®æ”¹å…¶ä»–é€šè¿‡Storesæ“ä½œæ•°æ®çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>å…¶ä»–éœ€è¦ä¿®æ”¹çš„å†…å®¹ï¼Œå¦‚:</p>
<ol>
<li>ç§»é™¤äº†<code>GetCurrent</code>æ–¹æ³•ï¼Œç»Ÿä¸€ä½¿ç”¨<code>GetCurrentAsync</code>.</li>
<li><code>ErrorMessage</code>å˜é‡åç§°ä¿®æ”¹æˆ<code>ErrorMsg</code>.</li>
</ol>
</li>
<li><p>ä½¿ç”¨ä»£ç æ¸…ç†åŠŸèƒ½ï¼Œå¹¶å¤„ç†å‘½åç©ºé—´å¼•ç”¨ç›¸å…³é”™è¯¯ã€‚</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿é¡¹ç›®ä¸­çš„åŒ…å¼•ç”¨æ·»åŠ åˆ°å½“å‰é¡¹ç›®ä¸­ã€‚</p>
</li>
<li><p>Buildé¡¹ç›®ï¼Œå¹¶ä¿®å¤å…¶ä»–ä¸šåŠ¡ä»£ç é”™è¯¯ï¼Œç›´æ¥æ„å»ºæˆåŠŸã€‚</p>
</li>
</ol>
<div class="markdown-alert markdown-alert-important">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p>
<p>8.0å¼€å§‹å¼•å…¥äº†æ¨¡å—æ¦‚å¿µï¼Œå¹¶ä¸”æ¨¡æ¿è‡ªå¸¦SystemModæ¨¡å—ï¼Œå¦‚æœä½ ä¸ä½¿ç”¨è¯¥æ¨¡å—ï¼Œå½“é‡åˆ°<code>SystemUser</code>ç­‰å¼•èµ·çš„é”™è¯¯ï¼Œå¯å°†ç›¸å…³åŠŸèƒ½ä»£ç åˆ é™¤æˆ–æ³¨é‡Šå³å¯ã€‚</p>
</div>
<h3 id="ä¿®å¤httpapi">ä¿®å¤Http.API</h3>
<ol>
<li><p>ç§»é™¤åŸºç¡€ç±»ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>IRestController.cs</li>
<li>RestControllerBase.cs</li>
<li>IRestApiBase.cs</li>
<li>JwtMiddleware.cs</li>
<li>RestApiBase.cs</li>
</ul>
<p>ä»¥ä¸Šå†…å®¹ä¸å†éœ€è¦æˆ–åœ¨Ater.Webé¡¹ç›®ä¸­å®ç°ã€‚</p>
</li>
<li><p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>Worker</code>å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ä¸­ã€‚å…¶ä¸­<code>InitDataTask.cs</code>è¯·ä»¥å½“å‰é¡¹ç›®ä¸ºå‡†ï¼Œæ—§é¡¹ç›®è¯¥æ–‡ä»¶å¯èƒ½åœ¨<code>Application</code>é¡¹ç›®ä¸­ï¼Œè¯·å°†è¯¥æ–‡ä»¶ç§»åŠ¨åˆ°<code>Http.API</code>é¡¹ç›®ï¼›</p>
<p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>ServiceCollectionExtension.cs</code>å¤åˆ¶åˆ°å½“å‰é¡¹ç›®æ ¹ç›®å½•ã€‚</p>
</li>
<li><p>ä¿®æ”¹Controllerçš„ç»§æ‰¿ã€‚
8.0ç®€åŒ–äº†Controllerï¼Œä¸å†éœ€è¦ç»§æ‰¿æ¥å£ã€‚æ¨¡æ¿æä¾›äº†ä¸¤ä¸ªåŸºç±»ï¼Œåˆ†åˆ«ç”¨äºåå°ç®¡ç†æƒé™(<code>RestControllerBase</code>)å’Œç”¨æˆ·ç«¯æƒé™(<code>ClientControllerBase</code>)ã€‚</p>
<p>é€šå¸¸åå°ç®¡ç†çš„æ§åˆ¶å™¨ä¼šä¿å­˜åœ¨<code>Controllers\AdminControllers</code>ç›®å½•ä¸­ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å°†åŸ</p>
<div class="language-csharp"><pre>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="className">ResourceGroupController</span> : <span class="className">RestControllerBase</span>&lt;<span class="symbol">ResourceGroupManager</span>&gt;, IRestController&lt;ResourceGroup, ResourceGroupAddDto, ResourceGroupUpdateDto, ResourceGroupFilterDto, ResourceGroupItemDto&gt;
<span class="controlKeyword">{</span>
<span class="controlKeyword">}</span>
</pre></div>
<p>ä¿®æ”¹æˆä»¥ä¸‹å½¢å¼:</p>
<div class="language-csharp"><pre>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="className">ResourceGroupController</span> : <span class="className">ClientControllerBase</span>&lt;<span class="symbol">ResourceGroupManager</span>&gt;
<span class="controlKeyword">{</span>
<span class="controlKeyword">}</span>
</pre></div>
<ol>
<li>ç§»é™¤æ¥å£ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ¹é…æ›¿æ¢æ¥ç§»é™¤æ¥å£ï¼Œæœç´¢<code>\bIRestController&lt;.+&gt;</code>,æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li>ä¿®æ”¹ç»§æ‰¿çš„åŸºç±»ï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…æ›¿æ¢ï¼Œæœç´¢<code>RestControllerBase&lt;([\w]+)Manager&gt;,</code>ï¼Œæ›¿æ¢æˆ<code>ClientControllerBase&lt;$1Manager&gt;</code>ã€‚</li>
</ol>
</li>
<li><p><code>GlobalUsings.cs</code>å†…å®¹å¦‚ä¸‹:</p>
<div class="language-csharp"><pre>
global <span class="keyword">using</span> <span class="className">System</span>.<span class="variable">Text</span>;
 global <span class="keyword">using</span> System.Text.<span class="className">Json</span>.<span class="variable">Serialization</span>;
 global <span class="keyword">using</span> Application;
 global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Const</span>;
 global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Implement</span>;
 global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Manager</span>;
 global <span class="keyword">using</span> <span class="className">Application</span>.<span class="variable">Services</span>;
 global <span class="keyword">using</span> Ater.<span class="className">Web</span>.<span class="variable">Abstraction</span>;
 global <span class="keyword">using</span> Ater.Web.<span class="className">Abstraction</span>.<span class="variable">Interface</span>;
 global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Models</span>;
 global <span class="keyword">using</span> Ater.Web.<span class="className">Core</span>.<span class="variable">Utils</span>;
 global <span class="keyword">using</span> Ater.Web.<span class="className">Extension</span>.<span class="variable">Services</span>;
 global <span class="keyword">using</span> Entity;
 global <span class="keyword">using</span> Http.<span class="className">API</span>.<span class="variable">Middleware</span>;
 global <span class="keyword">using</span> Microsoft.<span class="className">AspNetCore</span>.<span class="variable">Authorization</span>;
 global <span class="keyword">using</span> Microsoft.<span class="className">AspNetCore</span>.<span class="variable">Mvc</span>;
 global <span class="keyword">using</span> <span class="className">Microsoft</span>.<span class="variable">EntityFrameworkCore</span>;
 global <span class="keyword">using</span> Microsoft.<span class="className">Extensions</span>.<span class="variable">DependencyInjection</span>;
 global <span class="keyword">using</span> <span class="className">Share</span>.<span class="variable">Options</span>;
</pre></div>
</li>
<li><p>ä½¿ç”¨ä»£ç æ¸…ç†åŠŸèƒ½ï¼Œå¹¶å¤„ç†å‘½åç©ºé—´å¼•ç”¨ç›¸å…³çš„é”™è¯¯ã€‚</p>
</li>
<li><p>ä¿®æ”¹<code>Program.cs</code>.
æ–°æ¨¡æ¿å¯¹Programè¿›è¡Œäº†ç®€åŒ–ï¼Œå°†å¤§éƒ¨åˆ†çš„æœåŠ¡æ³¨å†Œå’Œä½¿ç”¨ç»Ÿä¸€æ”¾åˆ°äº†<code>ServiceCollectionExtension.cs</code>æ–‡ä»¶ä¸­ã€‚
å…¸å‹çš„<code>Program.cs</code>å†…å®¹å¦‚ä¸‹:</p>
<div class="language-csharp"><pre>
WebApplicationBuilder builder = <span class="className">WebApplication</span>.<span class="function">CreateBuilder</span><span class="controlKeyword">(</span>args<span class="controlKeyword">)</span>;    
<span class="comment">// 1 æ·»åŠ é»˜è®¤ç»„ä»¶</span>
<span class="variable">builder</span>.<span class="function">AddDefaultComponents</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="comment">// 2 æ³¨å†Œå’Œé…ç½®WebæœåŠ¡ä¾èµ–</span>
<span class="variable">builder</span>.<span class="function">AddDefaultWebServices</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="comment">// 3 å…¶ä»–è‡ªå®šä¹‰é€‰é¡¹åŠæœåŠ¡</span>
<span class="variable">builder</span>.Services.AddSingleton&lt;IEmailService, <span class="function">EmailService</span>&gt;<span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
WebApplication app = <span class="variable">builder</span>.<span class="function">Build</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="comment">// ä½¿ç”¨ä¸­é—´ä»¶</span>
<span class="variable">app</span>.<span class="function">UseDefaultWebServices</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="keyword">using</span> <span class="controlKeyword">(</span>app<span class="controlKeyword">)</span>
<span class="controlKeyword">{</span>
    <span class="comment">// åˆå§‹åŒ–å·¥ä½œ</span>
    <span class="keyword">await</span> <span class="keyword">using</span> <span class="controlKeyword">(</span>AsyncServiceScope scope = <span class="variable">app</span>.<span class="className">Services</span>.<span class="function">CreateAsyncScope</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span><span class="controlKeyword">)</span>
    <span class="controlKeyword">{</span>
        <span class="className">IServiceProvider</span> <span class="variable">provider</span> = <span class="variable">scope</span>.ServiceProvider;
        <span class="keyword">await</span> <span class="className">InitDataTask</span>.<span class="function">InitDataAsync</span><span class="controlKeyword">(</span>provider<span class="controlKeyword">)</span>;
    <span class="controlKeyword">}</span>
    <span class="variable">app</span>.<span class="function">Run</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="controlKeyword">}</span>
<span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="className">Program</span> <span class="controlKeyword">{</span> <span class="controlKeyword">}</span>
</pre></div>
<p>è¯·å°†<code>Program.cs</code>ä¸­çš„å†…å®¹éƒ½è¿ç§»åˆ°<code>ServiceCollectionExtension</code>ç±»ï¼Œè¯¥ç±»ä¸­ä»¥ä¸‹å†…å®¹ï¼Œå¦‚æœä¸éœ€è¦å¯ä»¥æ³¨é‡Šæˆ–åˆ é™¤</p>
<div class="language-csharp"><pre>
<span class="variable">builder</span>.Services.AddSingleton&lt;<span class="className">IEntityTaskQueue</span>&lt;<span class="symbol">UserLogs</span>&gt;, <span class="function">EntityTaskQueue</span>&lt;UserLogs&gt;&gt;<span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
<span class="comment">// æ·»åŠ åå°ç³»ç»Ÿæ¨¡å—æœåŠ¡</span>
<span class="variable">builder</span>.<span class="className">Services</span>.<span class="function">AddSystemModServices</span><span class="controlKeyword">(</span><span class="controlKeyword">)</span>;
</pre></div>
</li>
<li><p>å°†æ–°æ¨¡æ¿é¡¹ç›®ä¸­çš„åŒ…å¼•ç”¨æ·»åŠ åˆ°å½“å‰é¡¹ç›®ä¸­ã€‚</p>
</li>
<li><p>Buildé¡¹ç›®ï¼Œå¹¶ä¿®å¤å…¶ä»–ä¸šåŠ¡ä»£ç é”™è¯¯ï¼Œç›´åˆ°BuildæˆåŠŸã€‚</p>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p>
<p>æ–°æ¨¡æ¿ä¸­çš„<code>UserContext</code>ä¸­çš„<code>UserId</code>ä¸å†æ˜¯å¯ä¸ºç©ºçš„ï¼Œå¦‚æœä½ æœ‰ä½¿ç”¨ç±»ä¼¼äº<code>_user.UserId.Value</code>çš„åœ°æ–¹ï¼Œéœ€è¦ä¿®æ”¹æˆ<code>_user.UserId</code>.</p>
</div>
</li>
</ol>
<h3 id="æ›´æ–°appsettingsjson">æ›´æ–°appsettings.json</h3>
<p>ç§»é™¤å½“å‰é¡¹ç›®ä¸­çš„<code>Jwt</code>å’Œ<code>ConnectionStrings</code>é…ç½®é¡¹ã€‚</p>
<p>å°†æ–°æ¨¡æ¿ä¸­çš„<code>appsettings.json</code>å†…å®¹å¤åˆ¶åˆ°å½“å‰é¡¹ç›®ä¸­ï¼Œè¯·æ³¨æ„ï¼Œè‡ªå®šä¹‰çš„ä¸šåŠ¡é…ç½®é¡¹è¦ä¿ç•™ã€‚</p>
<p>åŒæ—¶ä¿®æ”¹<code>appsettings.Development.json</code>å’Œ<code>appsettings.Production.json</code>ä¸­çš„å†…å®¹ã€‚</p>
<div class="markdown-alert markdown-alert-important">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p>
<p>Jwté…ç½®é€‰é¡¹ç»“æ„å·²ç»ä¿®æ”¹ï¼Œæ‰€ä»¥ä½ éœ€è¦åŒæ­¥ä¿®æ”¹ä»£ç ä¸­è·å–Jwté…ç½®çš„ä»£ç ã€‚</p>
</div>
<h3 id="è¿è¡Œå¹¶æµ‹è¯•">è¿è¡Œå¹¶æµ‹è¯•</h3>
<p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤åï¼Œç¨‹åºå·²ç»å¯ä»¥æ„å»ºæˆåŠŸï¼Œä½†ä»ç„¶éœ€è¦ä½¿ç”¨æœ€æ–°çš„é…ç½®è¿è¡Œç¨‹åºã€‚æ¥ä¸‹æ¥éœ€è¦å¯¹æ¥å£è¿›è¡Œäººå·¥æµ‹è¯•ï¼Œä»¥è¯„ä¼°å‡çº§åæ˜¯å¦å­˜åœ¨é—®é¢˜ã€‚</p>
<h2 id="ç–‘éš¾é—®é¢˜">ç–‘éš¾é—®é¢˜</h2>
<p>8.0å¼€å§‹å°†swaggerè¿›è¡Œäº†åˆ†ç»„ï¼Œåˆ†åˆ«ä¸º<code>client</code>å’Œ<code>admin</code>åˆ†åˆ«å¯¹åº”ç”¨æˆ·ç«¯æ¥å£å’Œç®¡ç†ç«¯æ¥å£ã€‚</p>
<p>å¦‚æœå¼€å¯äº†æ‹†åˆ†æ§åˆ¶å™¨ï¼Œåœ¨ç”ŸæˆControllerçš„æ—¶å€™ï¼Œä¼šåˆ†åˆ«ç”Ÿæˆç”¨æˆ·ç«¯æ§åˆ¶å™¨å’Œç®¡ç†ç«¯æ§åˆ¶å™¨ã€‚</p>

        </div>
        <div class="hidden lg:block lg:col-span-1">
        <div class="toc-block sticky top-2">
 <p class="text-lg">å¯¼èˆª</p>
<ul class="toc">
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#å‡†å¤‡'">å‡†å¤‡</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#å‡çº§åˆ°.net8.0'">å‡çº§åˆ°.NET8.0</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#ç§»é™¤imanageræ¥å£å±‚'">ç§»é™¤IManageræ¥å£å±‚</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#é‡æ„åˆ°8.x'">é‡æ„åˆ°8.x</a>
</li>
</ul>
</div>

        </div>
      </div>
    </div>
    <div class="footer py-2 bottom-0 w-full fixed">
    <div class="container mx-auto text-center">
        <p class="text-neutral-600 dark:text-neutral-300 mb-0">
        ç‹¬æ€
        <a class="text-blue-600" target="_blank" href="https://github.com/AterDev/EasyBlog">Powered by Ater Blog</a>
        </p>
    </div>
  </div>
</body>
</html>