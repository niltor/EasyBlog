<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/app.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="icon" type="image/png" href="/favicon.ico" />
    <script src="/js/markdown.js"></script>
    <title>使用dotnet创建npm包</title>
    
</head>
<body class="px-4 sm:px-6 lg:px-8 dark:bg-neutral-900 pb-4">
    <div class="container mx-auto flex mt-2" style="margin-bottom: 48px;">
        <div class="sm:w-3/4 sm:pr-4 w-full markdown-content">
        <h1 id="使用dotnet创建npm包">使用dotnet创建npm包</h1>
<p>大家在使用npm包的时候，可能会遇到一些问题，比如在还原包(使用<code>npm install</code>)的时候会遇到报错，而报错信息可能会提示，需要C++编译环境，或者需要python环境。</p>
<p>包括现在前端的一些打包工具，它可能是使用C++或Rust编写的，但是我们都可以通过npm安装并使用。</p>
<p>这也就意味着，我们可以使用js/ts之外的语言来编写npm包。</p>
<h2 id="背景">背景</h2>
<p>我之前使用<code>C#</code>和<code>Angular</code>编写了一个<a href="https://github.com/AterDev/ater.dry.cli">代码生成器工具</a>，以<code>dotnet tool</code>的形式发布，以加速开发速度。</p>
<p>其中一个功能，是根据后端的<code>OpenAPI</code>文档内容来生成前端的请求服务代码。</p>
<p>当前端开发想要使用该功能时，就得先安装<code>dotnet sdk</code>，然后通过<code>dotnet tool install -g ater.dry</code>命令来安装该工具。
虽然也不麻烦，但稍显奇怪，毕竟对于前端来说，都有node环境，但不需要<code>dotnet</code>环境。</p>
<p>为了让更多前端能够使用这个工具，那么更好的办法是直接发布成<code>npm</code>包，在<code>package.json</code>文件中引用该包，在还原项目后，就可以直接使用该工具。</p>
<p>那么问题来了，难道让我重新使用js/ts来编写相关的逻辑么？那是万万不能的！</p>
<h2 id="使用dotnet编写npm包">使用dotnet编写npm包</h2>
<p>直到我偶然发现微软开源了一个项目<code>node-api-dotnet</code>，<a href="https://github.com/microsoft/node-api-dotnet"><code>Github</code>地址</a>。</p>
<p>该项目提供两个能力，即在<code>dotnet</code>程序中调用<code>js</code>，或在<code>nodejs</code>中调用<code>dotnet</code>。</p>
<p>这意味着，我之前已经使用好的<code>C#</code>代码，现在可以通过某种方式，在<code>node</code>项目中使用了。</p>
<p>于是按照这个思路，我对之前的程序进行了一些修改，并使用了<code>node-api-dotnet</code>，最终发布<code>npm</code>的命令行工具。目前我已经将两个项目发布成npm 命令行工具了。</p>
<ul>
<li><a href="https://www.npmjs.com/package/ater.dry"><code>ater.dry</code></a>，该工具就是根据OpenApi文档生成前端请求服务代码的工具。</li>
<li><a href="https://www.npmjs.com/package/ater.ezblog"><code>ater.ezblog</code></a>，该工具是一个博客静态网站生成器，可以根据markdown文件生成静态网站。</li>
</ul>
<p>当然，在使用的过程中遇到了一些问题，通过<a href="https://github.com/microsoft/node-api-dotnet/issues/336">反馈问题</a>，目前官方已经修复了该问题，并更新了文档示例。</p>
<p>我还没有尝试在<code>dotnet</code>项目中调用<code>node</code>项目，目前还没有这个需求。</p>

        </div>
        <div class="w-1/4 mt-1 hidden sm:flex">
            <div class="toc-block sticky top-2">
 <p class="text-lg">导航</p>
<ul class="toc">
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#背景'">背景</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#使用dotnet编写npm包'">使用dotnet编写npm包</a>
</li>
</ul>
</div>

        </div>
    </div>
    <div class="footer py-2 bottom-0 w-full fixed">
      <div class="container mx-auto text-center">
        <p class="text-neutral-600 dark:text-neutral-300 mb-0">
        独思
        <a class="text-blue-600" target="_blank" href="https://github.com/AterDev/EasyBlog">Powered by Ater Blog</a>
        </p>
      </div>
    </div>
</body>
</html>