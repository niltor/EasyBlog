<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="升级到Angular 16" />
    <link rel="stylesheet" href="/css/app.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="icon" type="image/png" href="/favicon.ico" />
    <script src="/js/markdown.js"></script>
    <title>升级到Angular 16-独思</title>
    
</head>
<body class="px-4 sm:px-6 lg:px-8 dark:bg-neutral-900 pb-4">
    <div class="container mx-auto flex mt-2" style="margin-bottom: 48px;">
        <div class="sm:w-3/4 sm:pr-4 w-full markdown-content">
        <h1 id="升级到angular-16">升级到Angular 16</h1>
<p>Angular 16版本带来了不少重大的变更，但官方的升级帮助页面却出现了重要的失误，缺失重要的升级步骤说明。本篇文章就介绍如何更新到最新的版本，以及如何快速的提高的程序的编译速度。</p>
<p>以下示例演示，如何从Angular14 升级到Angular16。</p>
<h2 id="前提条件">前提条件</h2>
<p>升级到Ng16 有些前提条件</p>
<ul>
<li>Node.js versions: v16 and v18.</li>
<li>TypeScript version 4.9.3 or later.</li>
<li>Zone.js version 0.13.x or later.</li>
</ul>
<h2 id="升级到v15">升级到v15</h2>
<p>手动修改<code>package.json</code>文件中的内容</p>
<div class="language-json"><pre>
<span class="jsonString">&quot;zone.js&quot;</span>: <span class="jsonString">&quot;~0.12.0&quot;</span>
<span class="jsonString">&quot;typescript&quot;</span>: <span class="jsonString">&quot;~4.9.0&quot;</span>
</pre></div>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p>
<p>请注意，这里我没有将包版本调整到符合Angular16的要求，因为我们当前版本是v14，我们要先升级到v15，然后再升级到v16，这里的包版本是对应v15的要求。</p>
</div>
<p>然后运行<code>pnpm install</code>或<code>npm install</code>。</p>
<h3 id="检测更新">检测更新</h3>
<p>使用<code>ng update</code>进行更新检测，工具会提示你哪些内容需要升级。</p>
<h3 id="更新v15依赖">更新v15依赖</h3>
<p>根据内容提示，先把版本更新升级到v15，然后再升级到v16，以下是示例:</p>
<div class="language-powershell"><pre>
ng update @angular<span class="powershellOperator">/</span>core@15 @angular<span class="powershellOperator">/</span>cli@15 
<span class="comment"># then commit your repo</span>
ng update @angular<span class="powershellOperator">/</span>material@15
</pre></div>
<h2 id="升级到v16">升级到v16</h2>
<p>先调整包版本</p>
<div class="language-json"><pre>
<span class="jsonString">&quot;zone.js&quot;</span>: <span class="jsonString">&quot;~0.13.0&quot;</span>
<span class="jsonString">&quot;typescript&quot;</span>: <span class="jsonString">&quot;~5.0.0&quot;</span>
</pre></div>
<p>然后执行<code>pnpm install</code>安装新版本包。</p>
<h3 id="更新v16依赖">更新v16依赖</h3>
<div class="language-powershell"><pre>
ng update
ng update @angular<span class="powershellOperator">/</span>core@16 @angular<span class="powershellOperator">/</span>cli@16 
<span class="comment"># then commit your repo</span>
ng update @angular<span class="powershellOperator">/</span>material@16
</pre></div>
<h3 id="错误排除">错误排除</h3>
<p>升级过程中遇到错误，有可能是网络问题，请尝试删除<code>node_modules</code>,然后重新<code>pnpm install</code>后再次尝试。</p>
<h3 id="其他内容">其他内容</h3>
<p>如果你还使用了其他类库，需要先确认是否支持Angular16。同时按照官方升级文档，处理其他潜在的问题。</p>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p>
<p>在执行<code>ng update</code>前，请先暂存当前仓库的内容，否则会警告无法执行！</p>
</div>
<h2 id="尝试使用esbuild构建">尝试使用esbuild构建</h2>
<p>升级v16有很多目的，我个人最主要的是尝试新的构建系统，实测，原先20+s的构建时间，可以缩减到7s，效果十分显著，使用起来也非常简单，我们来尝试一下。</p>
<p>修改<code>angular.json</code>中的配置：</p>
<div class="language-json"><pre>
<span class="jsonString">&quot;architect&quot;</span>: {
  <span class="jsonKey">&quot;build&quot;</span>: {
    <span class="jsonKey">&quot;builder&quot;</span>: <span class="jsonString">&quot;@angular-devkit/build-angular:browser-esbuild&quot;</span>,
    //...
  }
  //...
}
</pre></div>
<p>然后尝试一下<code>ng build</code>与<code>ng serve</code>，你会发现他们花费的时间差不多，build的时间大大缩减！</p>
<p>这比<code>signal</code>什么的香多了！</p>

        </div>
        <div class="w-1/4 mt-1 hidden sm:flex">
            <div class="toc-block sticky top-2">
 <p class="text-lg">导航</p>
<ul class="toc">
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#前提条件'">前提条件</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#升级到v15'">升级到v15</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#升级到v16'">升级到v16</a>
</li>
<li>
  <a href="javascript:void(0);" onclick="window.location.href=window.location.href.split('#')[0]+'#尝试使用esbuild构建'">尝试使用esbuild构建</a>
</li>
</ul>
</div>

        </div>
    </div>
    <div class="footer py-2 bottom-0 w-full fixed">
      <div class="container mx-auto text-center">
        <p class="text-neutral-600 dark:text-neutral-300 mb-0">
        独思
        <a class="text-blue-600" target="_blank" href="https://github.com/AterDev/EasyBlog">Powered by EasyDocs</a>
        </p>
      </div>
    </div>
</body>
</html>